# Single Node Development Configuration
# Simple deployment for development and testing

version: "1.0.0"
metadata:
  name: "single-node-dev"
  description: "Single node development environment"
  environment: "development"
  tags: ["development", "single-node"]

actors:
  polygon_collector:
    id: "polygon_collector"
    actor_type: "Producer"
    inputs: []
    outputs: ["market_data"]
    source_id: 1
    
    state:
      state_type: "InMemory"
      checkpoint_interval: "60s"
      max_state_size: 1073741824  # 1GB
      compression: true
    
    persistence:
      enabled: false
      recovery_strategy:
        FromBeginning: {}
    
    resources:
      min_memory_mb: 256
      max_memory_mb: 512
      min_cpu_cores: 1
      max_cpu_cores: 2
      disk_space_mb: 1024
      network_bandwidth_mbps: 100
      gpu_required: false
    
    health_check:
      enabled: true
      check_interval: "30s"
      timeout: "5s"
      failure_threshold: 3
      recovery_threshold: 2
      check_type: "Heartbeat"

  flash_arbitrage:
    id: "flash_arbitrage"
    actor_type: "Transformer"
    inputs: ["market_data"]
    outputs: ["arbitrage_signals"]
    source_id: 20
    
    state:
      state_type: "InMemory"
      checkpoint_interval: "30s"
      max_state_size: 536870912  # 512MB
      compression: true
    
    persistence:
      enabled: false
    
    resources:
      min_memory_mb: 512
      max_memory_mb: 1024
      min_cpu_cores: 2
      max_cpu_cores: 4
      disk_space_mb: 2048
      network_bandwidth_mbps: 100
      gpu_required: false
    
    health_check:
      enabled: true
      check_interval: "10s"
      timeout: "3s"
      failure_threshold: 3
      recovery_threshold: 2
      check_type:
        ProcessingRate:
          min_messages_per_second: 10.0

nodes:
  dev_node:
    hostname: "localhost"
    numa_topology: [0]
    
    local_channels:
      market_data:
        channel_type: "SPMC"  # Single Producer, Multiple Consumer
        buffer_size: 67108864  # 64MB
        numa_node: 0
        huge_pages: false
        priority: "High"
      
      arbitrage_signals:
        channel_type: "MPSC"  # Multiple Producer, Single Consumer
        buffer_size: 16777216  # 16MB
        numa_node: 0
        huge_pages: false
        priority: "RealTime"
    
    actor_placements:
      polygon_collector:
        numa: 0
        cpu: [0]
        memory_limit_mb: 512
        priority: "High"
        isolation:
          cpu_affinity: true
          memory_isolation: false
          network_namespace: null
          cgroup: null
      
      flash_arbitrage:
        numa: 0
        cpu: [1, 2]
        memory_limit_mb: 1024
        priority:
          RealTime:
            policy: "FIFO"
        isolation:
          cpu_affinity: true
          memory_isolation: false
          network_namespace: null
          cgroup: null
    
    node_resources:
      total_memory_mb: 8192  # 8GB
      total_cpu_cores: 4
      numa_nodes:
        - id: 0
          memory_mb: 8192
          cpu_cores: [0, 1, 2, 3]
          local_storage: []
      network_interfaces:
        - name: "lo"
          bandwidth_mbps: 1000
          mtu: 65536
          numa_node: 0
      storage: []
      gpu: null
    
    monitoring:
      metrics_collection:
        enabled: true
        collection_interval: "30s"
        retention_period: "24h"
        export_endpoint: null
      
      health_checks:
        - check_type: "CpuUsage"
          interval: "10s"
          timeout: "5s"
          threshold:
            warning: 80.0
            critical: 95.0
        - check_type: "MemoryUsage"
          interval: "10s"
          timeout: "5s"
          threshold:
            warning: 85.0
            critical: 95.0
      
      alerting:
        enabled: false
        webhook_url: null
        email_recipients: []
        severity_levels: ["Warning", "Critical"]

# No inter-node configuration needed for single node
inter_node: null